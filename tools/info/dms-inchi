#!/usr/bin/env desres-exec
# -*- python -*-
#{
# source `dirname $0`/../share/MODULES && \
# exec desres-cleanenv -m $NUMPY/lib-python \
# -- python $0 "$@"
#}

'''
dms-inchi [ options ] system.dms

Write distinct InChI strings derived from dms components to stdout.

Only connected components (fragments) of size 999 atoms or less will be
written, due to current limitations in the inchi-1 program.  

Note that covalently attached components will not be recognized or reported
as separate InChI strings.  

'''

import sys, os
sys.path.insert(0,os.path.join(os.path.dirname(__file__),'..','lib','python'))

import msys
from msys import inchi

def main():
    import optparse
    parser = optparse.OptionParser(__doc__)
    parser.add_option('--add-hydrogen', action='store_true', default=False,
        help='add H according to usual valences (default, all H are explicit)')
    parser.add_option('--include-stereo', action='store_true', default=False,
        help='include absolute stereo (default, exclude stereo)')
    parser.add_option('--without-fixed-hydrogen', action='store_true', 
        default=False, help='do not include fixed H layer')

    opts, args = parser.parse_args()
    for path in args:
        mol = msys.Load(path)
        print '\n'.join(inchi.Strings(mol, **opts.__dict__))

if __name__=="__main__": exit(main())

# vim: filetype=python
