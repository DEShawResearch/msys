#!/usr/bin/env desres-exec
# -*- python -*-
#{
# desres-cleanenv $MSYS_CLEANENV -- python $0 "$@"
#}

'''
dms-find-knot system.dms [ options ]
'''

import msys
from msys import knot
from optparse import OptionParser
import sys

if __name__ == "__main__":
    knot.ut_intersection()
    
    parser = OptionParser("Usage: dms_find_knot [options] system.dms.\n\nGiven a dms file, find any instances where a bond is 'threaded' through a ring.")

    parser.add_option("-s", "--selection", help="Limit knot search to selection")
    parser.add_option("--no_boxing", action="store_true", help="Turn off the 'boxing' optimization, which can potentially miss some knots.", default=False)

    (o,a) = parser.parse_args(sys.argv)
    if len(a)!=2:
        parser.error("Incorrect number of arguments")
 
    mol=msys.Load(a[1])
    klist = knot.FindKnots(
            mol,
            o.selection,
            use_boxing=(not o.no_boxing),
            verbose=True)

    sys.exit(len(klist)!=0)

# vim: filetype=python
